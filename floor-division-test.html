<!DOCTYPE html>
<html>
<head>
    <title>Floor Division Test</title>
</head>
<body>
    <h1>Testing Floor Division Assignment</h1>
    <div id="test-results"></div>
    
    <script>
        // Test the exact scenario
        function testFloorDivision() {
            const pythonEnvironment = new Map();
            const lines = ['apples = 17', 'apples //= 3', 'print(apples)'];
            let output = '';
            
            for (const line of lines) {
                console.log('Processing line:', line);
                
                if (line.startsWith('#') || !line) continue;
                
                // Handle compound assignment operators
                if (line.includes('//=') || line.includes('**=') || line.includes('+=') || 
                    line.includes('-=') || line.includes('*=') || line.includes('/=') || 
                    line.includes('%=')) {
                    
                    const operators = ['//=', '**=', '+=', '-=', '*=', '/=', '%='];
                    for (const op of operators) {
                        if (line.includes(op)) {
                            console.log('Found operator:', op);
                            const [varName, expression] = line.split(op).map(s => s.trim());
                            console.log('Variable:', varName, 'Expression:', expression);
                            
                            let currentVal = pythonEnvironment.get(varName) || 0;
                            console.log('Current value:', currentVal);
                            
                            if (typeof currentVal === 'object' && currentVal.isFloat) {
                                currentVal = currentVal.value;
                            }
                            
                            const newVal = parseInt(expression); // Simple for test
                            console.log('New value:', newVal);
                            
                            let result;
                            switch (op) {
                                case '//=': 
                                    result = Math.floor(currentVal / newVal); 
                                    console.log('Floor division result:', result);
                                    break;
                                default:
                                    result = currentVal;
                            }
                            
                            pythonEnvironment.set(varName, result);
                            console.log('Set', varName, 'to', result);
                            break;
                        }
                    }
                }
                // Handle regular variable assignments
                else if (line.includes(' = ') && !line.startsWith('print')) {
                    const [varName, expression] = line.split(' = ').map(s => s.trim());
                    const value = parseInt(expression); // Simple for test
                    pythonEnvironment.set(varName, value);
                    console.log('Set', varName, 'to', value);
                }
                // Handle print statements
                else if (line.startsWith('print(') && line.endsWith(')')) {
                    const expression = line.slice(6, -1);
                    const result = pythonEnvironment.get(expression);
                    output += result + '\n';
                    console.log('Print result:', result);
                }
            }
            
            return output.trim();
        }
        
        const result = testFloorDivision();
        document.getElementById('test-results').innerHTML = `
            <h2>Test Result:</h2>
            <p><strong>Expected:</strong> 5</p>
            <p><strong>Actual:</strong> ${result}</p>
            <p><strong>Status:</strong> ${result === '5' ? '✅ PASS' : '❌ FAIL'}</p>
            <p>Check console for detailed logs.</p>
        `;
    </script>
</body>
</html>
