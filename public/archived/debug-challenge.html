<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Challenge - Code with Morais</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .challenge-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .code-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .panel-title {
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }

        .code-editor {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            min-height: 300px;
            position: relative;
            overflow-x: auto;
        }

        .code-textarea {
            width: 100%;
            height: 300px;
            background: #2c3e50;
            color: #ecf0f1;
            border: none;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            padding: 10px;
            resize: vertical;
            outline: none;
        }

        .output-panel {
            background: #34495e;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            min-height: 200px;
            margin-top: 15px;
        }

        .error-output {
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
            padding: 10px;
            border-radius: 5px;
            margin: 5px 0;
        }

        .success-output {
            color: #27ae60;
            background: rgba(39, 174, 96, 0.1);
            padding: 10px;
            border-radius: 5px;
            margin: 5px 0;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn-success { background: #27ae60; }
        .btn-success:hover { background: #229954; }

        .btn-danger { background: #e74c3c; }
        .btn-danger:hover { background: #c0392b; }

        .btn-warning { background: #f39c12; }
        .btn-warning:hover { background: #d68910; }

        .challenge-selector {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .challenge-tabs {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .challenge-tab {
            background: #ecf0f1;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .challenge-tab.active {
            background: #3498db;
            color: white;
        }

        .challenge-tab.completed {
            background: #27ae60;
            color: white;
        }

        .challenge-description {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .hint-section {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            display: none;
        }

        .progress-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-item {
            background: #3498db;
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .syntax-highlighting {
            /* Basic syntax highlighting styles */
        }

        .keyword { color: #ff6b6b; }
        .string { color: #4ecdc4; }
        .comment { color: #95a5a6; }
        .number { color: #f39c12; }

        @media (max-width: 768px) {
            .challenge-grid {
                grid-template-columns: 1fr;
            }
            
            .controls {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üêõ Debug Challenge Arena</h1>
            <p>Fix broken code and become a debugging master!</p>
        </div>

        <div class="progress-section">
            <h3>Your Progress</h3>
            <div class="progress-bar">
                <div class="progress-fill" id="overall-progress"></div>
            </div>
            <div class="stats-grid">
                <div class="stat-item">
                    <div id="completed-challenges">0</div>
                    <div>Completed</div>
                </div>
                <div class="stat-item">
                    <div id="total-attempts">0</div>
                    <div>Attempts</div>
                </div>
                <div class="stat-item">
                    <div id="success-rate">0%</div>
                    <div>Success Rate</div>
                </div>
                <div class="stat-item">
                    <div id="current-streak">0</div>
                    <div>Streak</div>
                </div>
            </div>
        </div>

        <div class="challenge-selector">
            <h3>Select Challenge</h3>
            <div class="challenge-tabs" id="challenge-tabs">
                <!-- Challenge tabs will be populated by JavaScript -->
            </div>
            <div class="challenge-description" id="challenge-description">
                <!-- Challenge description will be populated by JavaScript -->
            </div>
        </div>

        <div class="challenge-grid">
            <div class="code-panel">
                <h3 class="panel-title">üîß Code Editor</h3>
                <div class="controls">
                    <button class="btn btn-success" onclick="runCode()">‚ñ∂Ô∏è Run Code</button>
                    <button class="btn btn-warning" onclick="showHint()">üí° Hint</button>
                    <button class="btn" onclick="resetCode()">üîÑ Reset</button>
                    <button class="btn btn-danger" onclick="showSolution()">üîë Show Solution</button>
                </div>
                <textarea class="code-textarea" id="code-editor" placeholder="Your code will appear here..."></textarea>
                <div class="hint-section" id="hint-section">
                    <strong>üí° Hint:</strong> <span id="hint-text"></span>
                </div>
            </div>

            <div class="code-panel">
                <h3 class="panel-title">üìä Output & Errors</h3>
                <div class="controls">
                    <button class="btn" onclick="clearOutput()">üóëÔ∏è Clear Output</button>
                    <button class="btn" onclick="analyzeErrors()">üîç Analyze Errors</button>
                </div>
                <div class="output-panel" id="output-panel">
                    <div style="color: #7f8c8d;">Run your code to see output and errors here...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Challenge data
        const challenges = [
            {
                id: 1,
                title: "Syntax Fix: Parentheses",
                difficulty: "Easy",
                description: "Fix the missing parentheses in this function call.",
                code: `def greet(name):
    return f"Hello, {name}!"

# Fix the syntax error below
message = greet("Alice"
print(message)`,
                solution: `def greet(name):
    return f"Hello, {name}!"

# Fixed: Added missing closing parenthesis
message = greet("Alice")
print(message)`,
                hint: "Look for unmatched parentheses in the function call.",
                expectedOutput: "Hello, Alice!",
                category: "syntax"
            },
            {
                id: 2,
                title: "Index Error Fix",
                difficulty: "Easy",
                description: "Fix the index error when accessing list elements.",
                code: `fruits = ["apple", "banana", "orange"]

# This will cause an IndexError
for i in range(5):
    print(f"Fruit {i+1}: {fruits[i]}")`,
                solution: `fruits = ["apple", "banana", "orange"]

# Fixed: Use the actual length of the list
for i in range(len(fruits)):
    print(f"Fruit {i+1}: {fruits[i]}")`,
                hint: "Check the range of your loop against the length of the list.",
                expectedOutput: "Fruit 1: apple\nFruit 2: banana\nFruit 3: orange",
                category: "runtime"
            },
            {
                id: 3,
                title: "Type Error Fix", 
                difficulty: "Easy",
                description: "Fix the type error when concatenating string and integer.",
                code: `name = "Alice"
age = 25

# This will cause a TypeError
message = "My name is " + name + " and I am " + age + " years old"
print(message)`,
                solution: `name = "Alice"
age = 25

# Fixed: Convert age to string or use f-string
message = f"My name is {name} and I am {age} years old"
# Alternative: message = "My name is " + name + " and I am " + str(age) + " years old"
print(message)`,
                hint: "You cannot concatenate strings and integers directly. Use str() or f-strings.",
                expectedOutput: "My name is Alice and I am 25 years old",
                category: "runtime"
            },
            {
                id: 4,
                title: "Logic Error: Wrong Formula",
                difficulty: "Medium",
                description: "Fix the incorrect mathematical formula for calculating circle area.",
                code: `import math

def calculate_circle_area(radius):
    # Wrong formula - missing square of radius
    area = math.pi * radius
    return area

# Test the function
radius = 5
area = calculate_circle_area(radius)
print(f"Area of circle with radius {radius}: {area}")`,
                solution: `import math

def calculate_circle_area(radius):
    # Fixed: Correct formula is œÄ * r¬≤
    area = math.pi * radius * radius
    # Alternative: area = math.pi * (radius ** 2)
    return area

# Test the function
radius = 5
area = calculate_circle_area(radius)
print(f"Area of circle with radius {radius}: {area}")`,
                hint: "The formula for circle area is œÄ √ó radius¬≤. What's missing?",
                expectedOutput: "Area of circle with radius 5: 78.53981633974483",
                category: "logic"
            },
            {
                id: 5,
                title: "Division by Zero",
                difficulty: "Medium",
                description: "Add error handling for division by zero.",
                code: `def calculate_average(numbers):
    total = sum(numbers)
    count = len(numbers)
    # This will fail with empty list
    return total / count

# Test cases
test_lists = [[1, 2, 3, 4, 5], [], [10, 20]]

for test_list in test_lists:
    avg = calculate_average(test_list)
    print(f"Average of {test_list}: {avg}")`,
                solution: `def calculate_average(numbers):
    if len(numbers) == 0:
        return 0  # or raise ValueError("Cannot calculate average of empty list")
    
    total = sum(numbers)
    count = len(numbers)
    return total / count

# Test cases
test_lists = [[1, 2, 3, 4, 5], [], [10, 20]]

for test_list in test_lists:
    avg = calculate_average(test_list)
    print(f"Average of {test_list}: {avg}")`,
                hint: "Check if the list is empty before dividing by its length.",
                expectedOutput: "Average of [1, 2, 3, 4, 5]: 3.0\nAverage of []: 0\nAverage of [10, 20]: 15.0",
                category: "runtime"
            },
            {
                id: 6,
                title: "Indentation Error",
                difficulty: "Easy",
                description: "Fix the indentation errors in this if-else structure.",
                code: `def check_grade(score):
    if score >= 90:
        grade = "A"
    elif score >= 80:
        grade = "B"
    elif score >= 70:
        grade = "C"
       else:  # Wrong indentation
        grade = "F"
    return grade

print(check_grade(85))`,
                solution: `def check_grade(score):
    if score >= 90:
        grade = "A"
    elif score >= 80:
        grade = "B"
    elif score >= 70:
        grade = "C"
    else:  # Fixed: Proper indentation
        grade = "F"
    return grade

print(check_grade(85))`,
                hint: "Check the indentation of the 'else' statement. It should align with 'if' and 'elif'.",
                expectedOutput: "B",
                category: "syntax"
            },
            {
                id: 7,
                title: "Dictionary KeyError",
                difficulty: "Medium", 
                description: "Handle missing dictionary keys safely.",
                code: `student_info = {
    "name": "John Doe",
    "age": 20,
    "major": "Computer Science"
}

# These will cause KeyErrors
print(f"Name: {student_info['name']}")
print(f"Age: {student_info['age']}")
print(f"GPA: {student_info['gpa']}")  # Key doesn't exist
print(f"Email: {student_info['email']}")  # Key doesn't exist`,
                solution: `student_info = {
    "name": "John Doe",
    "age": 20,
    "major": "Computer Science"
}

# Fixed: Use .get() method for safe access
print(f"Name: {student_info.get('name', 'Unknown')}")
print(f"Age: {student_info.get('age', 'Unknown')}")
print(f"GPA: {student_info.get('gpa', 'Not available')}")
print(f"Email: {student_info.get('email', 'Not provided')}")`,
                hint: "Use the .get() method to safely access dictionary keys that might not exist.",
                expectedOutput: "Name: John Doe\nAge: 20\nGPA: Not available\nEmail: Not provided",
                category: "runtime"
            },
            {
                id: 8,
                title: "Variable Scope Issue",
                difficulty: "Hard",
                description: "Fix the variable scope problem in this function.",
                code: `def process_numbers():
    numbers = [1, 2, 3, 4, 5]
    
    if len(numbers) > 0:
        result = sum(numbers)
    
    # This might cause NameError in some cases
    return result * 2

def another_function():
    # This will definitely cause NameError
    return result + 10

print(process_numbers())
print(another_function())`,
                solution: `def process_numbers():
    numbers = [1, 2, 3, 4, 5]
    result = 0  # Initialize result before conditional
    
    if len(numbers) > 0:
        result = sum(numbers)
    
    return result * 2

def another_function():
    # Fixed: Get result from process_numbers()
    result = process_numbers() // 2  # Get original result
    return result + 10

print(process_numbers())
print(another_function())`,
                hint: "Variables defined inside if blocks might not exist if the condition is false. Initialize variables before conditionals.",
                expectedOutput: "30\n25",
                category: "runtime"
            },
            {
                id: 9,
                title: "Infinite Loop Fix",
                difficulty: "Hard",
                description: "Fix the infinite loop by adding proper loop control.",
                code: `def countdown(start):
    current = start
    print(f"Starting countdown from {start}")
    
    while current > 0:
        print(f"Count: {current}")
        # Missing: decrement current
        # This creates an infinite loop!
    
    print("Countdown complete!")

# Be careful running this!
countdown(5)`,
                solution: `def countdown(start):
    current = start
    print(f"Starting countdown from {start}")
    
    while current > 0:
        print(f"Count: {current}")
        current -= 1  # Fixed: Decrement the counter
    
    print("Countdown complete!")

countdown(5)`,
                hint: "What needs to change inside the loop to eventually make the condition false?",
                expectedOutput: "Starting countdown from 5\nCount: 5\nCount: 4\nCount: 3\nCount: 2\nCount: 1\nCountdown complete!",
                category: "logic"
            },
            {
                id: 10,
                title: "File Handling Errors",
                difficulty: "Hard",
                description: "Add proper error handling for file operations.",
                code: `def read_file_content(filename):
    # No error handling - multiple potential errors
    file = open(filename, 'r')
    content = file.read()
    file.close()
    return content.upper()

def process_file(filename):
    content = read_file_content(filename)
    words = content.split()
    return len(words)

# This will likely cause errors
result = process_file("nonexistent.txt")
print(f"Word count: {result}")`,
                solution: `def read_file_content(filename):
    try:
        with open(filename, 'r') as file:
            content = file.read()
        return content.upper()
    except FileNotFoundError:
        print(f"Error: File '{filename}' not found")
        return ""
    except PermissionError:
        print(f"Error: Permission denied to read '{filename}'")
        return ""
    except Exception as e:
        print(f"Unexpected error: {e}")
        return ""

def process_file(filename):
    content = read_file_content(filename)
    if content:  # Check if content is not empty
        words = content.split()
        return len(words)
    return 0

# Test with error handling
result = process_file("nonexistent.txt")
print(f"Word count: {result}")`,
                hint: "Use try-except blocks to handle FileNotFoundError and other exceptions. Consider using 'with' statement for automatic file closing.",
                expectedOutput: "Error: File 'nonexistent.txt' not found\nWord count: 0",
                category: "runtime"
            }
        ];

        // Game state
        let currentChallenge = 0;
        let completedChallenges = new Set();
        let totalAttempts = 0;
        let successfulAttempts = 0;
        let currentStreak = 0;

        function initializeGame() {
            createChallengeTabs();
            loadChallenge(0);
            updateStats();
        }

        function createChallengeTabs() {
            const tabsContainer = document.getElementById('challenge-tabs');
            tabsContainer.innerHTML = '';

            challenges.forEach((challenge, index) => {
                const tab = document.createElement('button');
                tab.className = 'challenge-tab';
                tab.textContent = `${index + 1}. ${challenge.title}`;
                tab.onclick = () => loadChallenge(index);
                
                if (index === currentChallenge) {
                    tab.classList.add('active');
                }
                
                if (completedChallenges.has(index)) {
                    tab.classList.add('completed');
                }
                
                tabsContainer.appendChild(tab);
            });
        }

        function loadChallenge(index) {
            currentChallenge = index;
            const challenge = challenges[index];
            
            document.getElementById('code-editor').value = challenge.code;
            document.getElementById('challenge-description').innerHTML = `
                <h4>${challenge.title} (${challenge.difficulty})</h4>
                <p>${challenge.description}</p>
                <p><strong>Category:</strong> ${challenge.category} error</p>
            `;
            
            document.getElementById('hint-text').textContent = challenge.hint;
            document.getElementById('hint-section').style.display = 'none';
            
            clearOutput();
            createChallengeTabs();
        }

        function runCode() {
            const code = document.getElementById('code-editor').value;
            const output = document.getElementById('output-panel');
            totalAttempts++;
            
            try {
                // Simple simulation of code execution
                // In a real implementation, you'd need a proper Python interpreter
                const result = simulateCodeExecution(code);
                
                if (result.success) {
                    output.innerHTML = `<div class="success-output">‚úÖ Code executed successfully!<br>${result.output}</div>`;
                    
                    // Check if challenge is completed
                    if (isChallengeSolved(code)) {
                        handleChallengeCompletion();
                    }
                } else {
                    output.innerHTML = `<div class="error-output">‚ùå Error found:<br>${result.error}</div>`;
                }
            } catch (error) {
                output.innerHTML = `<div class="error-output">‚ùå Execution error:<br>${error.message}</div>`;
            }
            
            updateStats();
        }

        function simulateCodeExecution(code) {
            // This is a simplified simulation
            // In a real app, you'd use a Python interpreter or web service
            
            const challenge = challenges[currentChallenge];
            
            // Check for common syntax errors
            if (code.includes('greet("Alice"') && !code.includes('greet("Alice")')) {
                return { success: false, error: 'SyntaxError: unexpected EOF while parsing' };
            }
            
            if (code.includes('range(5)') && code.includes('fruits[i]') && !code.includes('range(len(fruits))')) {
                return { success: false, error: 'IndexError: list index out of range' };
            }
            
            if (code.includes('+ age +') && !code.includes('str(age)') && !code.includes('f"') && !code.includes('{age}')) {
                return { success: false, error: 'TypeError: can only concatenate str (not "int") to str' };
            }
            
            if (code.includes('math.pi * radius') && !code.includes('radius * radius') && !code.includes('radius ** 2')) {
                return { success: true, output: 'Area of circle with radius 5: 15.707963267948966\n(Note: This looks wrong - check your formula!)' };
            }
            
            if (code.includes('return total / count') && !code.includes('if len(numbers)') && !code.includes('if count')) {
                return { success: false, error: 'ZeroDivisionError: division by zero' };
            }
            
            // If we get here, assume the code is likely correct
            return { success: true, output: challenge.expectedOutput };
        }

        function isChallengeSolved(code) {
            const challenge = challenges[currentChallenge];
            
            // Simple checks for common fixes
            switch (challenge.id) {
                case 1:
                    return code.includes('greet("Alice")');
                case 2:
                    return code.includes('range(len(fruits))') || code.includes('range(3)');
                case 3:
                    return code.includes('f"') || code.includes('str(age)');
                case 4:
                    return code.includes('radius * radius') || code.includes('radius ** 2');
                case 5:
                    return code.includes('if len(numbers)') || code.includes('if count');
                case 6:
                    return !code.includes('   else:') && code.includes('else:');
                case 7:
                    return code.includes('.get(');
                case 8:
                    return code.includes('result = 0') || code.includes('result =');
                case 9:
                    return code.includes('current -= 1') || code.includes('current = current - 1');
                case 10:
                    return code.includes('try:') && code.includes('except');
                default:
                    return false;
            }
        }

        function handleChallengeCompletion() {
            if (!completedChallenges.has(currentChallenge)) {
                completedChallenges.add(currentChallenge);
                successfulAttempts++;
                currentStreak++;
                
                document.getElementById('output-panel').innerHTML += 
                    '<div class="success-output">üéâ Challenge completed! Great job!</div>';
                
                updateStats();
                createChallengeTabs();
                
                // Auto-advance to next challenge after a delay
                setTimeout(() => {
                    if (currentChallenge < challenges.length - 1) {
                        loadChallenge(currentChallenge + 1);
                    }
                }, 2000);
            }
        }

        function showHint() {
            document.getElementById('hint-section').style.display = 'block';
        }

        function resetCode() {
            const challenge = challenges[currentChallenge];
            document.getElementById('code-editor').value = challenge.code;
            clearOutput();
        }

        function showSolution() {
            const challenge = challenges[currentChallenge];
            document.getElementById('code-editor').value = challenge.solution;
            document.getElementById('output-panel').innerHTML = 
                '<div style="color: #f39c12;">üí° Solution loaded. Try to understand the fixes before moving on!</div>';
        }

        function clearOutput() {
            document.getElementById('output-panel').innerHTML = 
                '<div style="color: #7f8c8d;">Run your code to see output and errors here...</div>';
        }

        function analyzeErrors() {
            const code = document.getElementById('code-editor').value;
            const output = document.getElementById('output-panel');
            
            let analysis = '<div style="color: #3498db;"><strong>üîç Code Analysis:</strong><br>';
            
            // Basic static analysis
            if (code.includes('(') && !code.includes(')')) {
                analysis += '‚Ä¢ Missing closing parenthesis<br>';
            }
            if (code.includes('[') && !code.includes(']')) {
                analysis += '‚Ä¢ Missing closing bracket<br>';
            }
            if (code.includes('"') && (code.match(/"/g) || []).length % 2 !== 0) {
                analysis += '‚Ä¢ Unmatched quotation marks<br>';
            }
            if (code.includes('range(') && code.includes('[i]')) {
                analysis += '‚Ä¢ Potential index out of range - check loop bounds<br>';
            }
            if (code.includes(' + ') && /\d/.test(code) && /".*"/.test(code)) {
                analysis += '‚Ä¢ Possible type error - mixing strings and numbers<br>';
            }
            
            analysis += '</div>';
            output.innerHTML = analysis;
        }

        function updateStats() {
            const completed = completedChallenges.size;
            const total = challenges.length;
            const successRate = totalAttempts > 0 ? Math.round((successfulAttempts / totalAttempts) * 100) : 0;
            
            document.getElementById('completed-challenges').textContent = `${completed}/${total}`;
            document.getElementById('total-attempts').textContent = totalAttempts;
            document.getElementById('success-rate').textContent = `${successRate}%`;
            document.getElementById('current-streak').textContent = currentStreak;
            
            const progress = (completed / total) * 100;
            document.getElementById('overall-progress').style.width = `${progress}%`;
        }

        // Initialize the game when the page loads
        document.addEventListener('DOMContentLoaded', initializeGame);
    </script>
</body>
</html>