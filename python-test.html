<!DOCTYPE html>
<html>
<head>
    <title>Python Simulator Test</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        .test-case { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .code { background: #f5f5f5; padding: 10px; margin: 10px 0; }
        .output { background: #e8f5e8; padding: 10px; margin: 10px 0; }
        .expected { background: #fff8dc; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Python Simulator Test Cases</h1>
    
    <div class="test-case">
        <h3>Test 1: Integer vs Float</h3>
        <div class="code">
a = 5
b = 2
print(a + b)
print(type(a + b))
print(a / b)
print(type(a / b))
        </div>
        <div class="expected">Expected: 7, &lt;class 'int'&gt;, 2.5, &lt;class 'float'&gt;</div>
        <div class="output" id="output1"></div>
        <button onclick="runTest1()">Run Test 1</button>
    </div>

    <div class="test-case">
        <h3>Test 2: String Operations</h3>
        <div class="code">
text = "Hello World"
print(text.upper())
print(text.lower())
print("Python" in text)
print(len(text))
        </div>
        <div class="expected">Expected: HELLO WORLD, hello world, False, 11</div>
        <div class="output" id="output2"></div>
        <button onclick="runTest2()">Run Test 2</button>
    </div>

    <div class="test-case">
        <h3>Test 3: Type Conversions</h3>
        <div class="code">
num = 42
text_num = "123"
print(str(num))
print(int(text_num))
print(type(str(num)))
print(type(int(text_num)))
        </div>
        <div class="expected">Expected: 42, 123, &lt;class 'str'&gt;, &lt;class 'int'&gt;</div>
        <div class="output" id="output3"></div>
        <button onclick="runTest3()">Run Test 3</button>
    </div>

    <div class="test-case">
        <h3>Test 4: Print with Multiple Arguments</h3>
        <div class="code">
name = "Alice"
age = 25
print("Name:", name, "Age:", age)
print("Sum:", 10, "+", 5, "=", 15)
        </div>
        <div class="expected">Expected: Name: Alice Age: 25, Sum: 10 + 5 = 15</div>
        <div class="output" id="output4"></div>
        <button onclick="runTest4()">Run Test 4</button>
    </div>

    <script>
        // Copy the Python simulation functions from test.js
        function simulatePythonExecution(code) {
            let output = '';
            const environment = new Map();
            
            try {
                const lines = code.split('\n').map(line => line.trim()).filter(line => line && !line.startsWith('#'));
                
                for (const line of lines) {
                    // Handle variable assignments
                    if (line.includes(' = ') && !line.startsWith('print')) {
                        const [varName, expression] = line.split(' = ').map(s => s.trim());
                        const value = evaluateExpression(expression, environment);
                        environment.set(varName, value);
                    }
                    // Handle print statements (support multiple arguments)
                    else if (line.startsWith('print(') && line.endsWith(')')) {
                        const content = line.slice(6, -1).trim();
                        
                        if (!content) {
                            output += '\n';
                        } else if (content.includes(',')) {
                            const args = [];
                            let currentArg = '';
                            let parenCount = 0;
                            let inQuotes = false;
                            let quoteChar = '';
                            
                            for (let i = 0; i < content.length; i++) {
                                const char = content[i];
                                
                                if ((char === '"' || char === "'") && !inQuotes) {
                                    inQuotes = true;
                                    quoteChar = char;
                                    currentArg += char;
                                } else if (char === quoteChar && inQuotes) {
                                    inQuotes = false;
                                    quoteChar = '';
                                    currentArg += char;
                                } else if (char === '(' && !inQuotes) {
                                    parenCount++;
                                    currentArg += char;
                                } else if (char === ')' && !inQuotes) {
                                    parenCount--;
                                    currentArg += char;
                                } else if (char === ',' && !inQuotes && parenCount === 0) {
                                    args.push(currentArg.trim());
                                    currentArg = '';
                                } else {
                                    currentArg += char;
                                }
                            }
                            
                            if (currentArg.trim()) {
                                args.push(currentArg.trim());
                            }
                            
                            const results = args.map(arg => {
                                const value = evaluateExpression(arg, environment);
                                return formatOutput(value);
                            });
                            output += results.join(' ') + '\n';
                        } else {
                            const result = evaluateExpression(content, environment);
                            output += formatOutput(result) + '\n';
                        }
                    }
                }
                
                return output.trim();
            } catch (error) {
                throw new Error(`Execution error: ${error.message}`);
            }
        }

        function evaluateExpression(expression, environment) {
            expression = expression.trim();
            
            // Handle string literals
            if ((expression.startsWith('"') && expression.endsWith('"')) || 
                (expression.startsWith("'") && expression.endsWith("'"))) {
                return expression.slice(1, -1);
            }
            
            // Handle numbers (preserve int vs float distinction)
            if (/^-?\d+$/.test(expression)) {
                return parseInt(expression);
            }
            if (/^-?\d+\.\d+$/.test(expression)) {
                return parseFloat(expression);
            }
            
            // Handle boolean literals
            if (expression === 'True') return true;
            if (expression === 'False') return false;
            if (expression === 'None') return null;
            
            // Handle type() function calls
            if (expression.startsWith('type(') && expression.endsWith(')')) {
                const innerExpr = expression.slice(5, -1).trim();
                const value = evaluateExpression(innerExpr, environment);
                return getType(value);
            }
            
            // Handle conversion functions
            if (expression.startsWith('str(') && expression.endsWith(')')) {
                const innerExpr = expression.slice(4, -1).trim();
                const value = evaluateExpression(innerExpr, environment);
                if (value === true) return 'True';
                if (value === false) return 'False';
                if (value === null) return 'None';
                return String(value);
            }
            if (expression.startsWith('int(') && expression.endsWith(')')) {
                const innerExpr = expression.slice(4, -1).trim();
                const value = evaluateExpression(innerExpr, environment);
                if (typeof value === 'string') {
                    const num = parseFloat(value);
                    if (isNaN(num)) throw new Error(`invalid literal for int()`);
                    return Math.trunc(num);
                }
                if (typeof value === 'boolean') return value ? 1 : 0;
                return Math.trunc(Number(value));
            }
            
            // Handle len() function
            if (expression.startsWith('len(') && expression.endsWith(')')) {
                const innerExpr = expression.slice(4, -1).trim();
                const value = evaluateExpression(innerExpr, environment);
                if (typeof value === 'string' || Array.isArray(value)) {
                    return value.length;
                }
                return 0;
            }
            
            // Handle string methods
            if (expression.includes('.upper()')) {
                const base = expression.replace('.upper()', '');
                const value = evaluateExpression(base, environment);
                return String(value).toUpperCase();
            }
            if (expression.includes('.lower()')) {
                const base = expression.replace('.lower()', '');
                const value = evaluateExpression(base, environment);
                return String(value).toLowerCase();
            }
            
            // Handle membership operators
            if (expression.includes(' in ')) {
                const [left, right] = expression.split(' in ').map(part => part.trim());
                const leftVal = evaluateExpression(left, environment);
                const rightVal = evaluateExpression(right, environment);
                if (typeof rightVal === 'string') {
                    return rightVal.includes(leftVal);
                }
                return false;
            }
            
            // Handle arithmetic operations
            if (expression.includes(' + ')) {
                const parts = expression.split(' + ');
                if (parts.length === 2) {
                    const left = evaluateExpression(parts[0].trim(), environment);
                    const right = evaluateExpression(parts[1].trim(), environment);
                    return left + right;
                }
            }
            
            if (expression.includes(' / ')) {
                const [left, right] = expression.split(' / ').map(part => evaluateExpression(part.trim(), environment));
                return left / right;
            }
            
            // Handle variables
            if (environment.has(expression)) {
                return environment.get(expression);
            }
            
            return expression;
        }

        function getType(value) {
            if (typeof value === 'string') return "<class 'str'>";
            if (typeof value === 'number') {
                return Number.isInteger(value) ? "<class 'int'>" : "<class 'float'>";
            }
            if (typeof value === 'boolean') return "<class 'bool'>";
            if (Array.isArray(value)) return "<class 'list'>";
            if (value === null) return "<class 'NoneType'>";
            return "<class 'object'>";
        }

        function formatOutput(value) {
            if (typeof value === 'string') return value;
            if (typeof value === 'number') {
                if (Number.isInteger(value)) return value.toString();
                return value.toString();
            }
            if (typeof value === 'boolean') return value ? 'True' : 'False';
            if (Array.isArray(value)) {
                const formattedItems = value.map(item => {
                    if (typeof item === 'string') return `'${item}'`;
                    if (typeof item === 'boolean') return item ? 'True' : 'False';
                    if (typeof item === 'number' && Number.isInteger(item)) return item.toString();
                    return formatOutput(item);
                });
                return `[${formattedItems.join(', ')}]`;
            }
            if (value === null) return 'None';
            return String(value);
        }

        function runTest1() {
            const code = `a = 5
b = 2
print(a + b)
print(type(a + b))
print(a / b)
print(type(a / b))`;
            try {
                const result = simulatePythonExecution(code);
                document.getElementById('output1').textContent = result;
            } catch (error) {
                document.getElementById('output1').textContent = 'Error: ' + error.message;
            }
        }

        function runTest2() {
            const code = `text = "Hello World"
print(text.upper())
print(text.lower())
print("Python" in text)
print(len(text))`;
            try {
                const result = simulatePythonExecution(code);
                document.getElementById('output2').textContent = result;
            } catch (error) {
                document.getElementById('output2').textContent = 'Error: ' + error.message;
            }
        }

        function runTest3() {
            const code = `num = 42
text_num = "123"
print(str(num))
print(int(text_num))
print(type(str(num)))
print(type(int(text_num)))`;
            try {
                const result = simulatePythonExecution(code);
                document.getElementById('output3').textContent = result;
            } catch (error) {
                document.getElementById('output3').textContent = 'Error: ' + error.message;
            }
        }

        function runTest4() {
            const code = `name = "Alice"
age = 25
print("Name:", name, "Age:", age)
print("Sum:", 10, "+", 5, "=", 15)`;
            try {
                const result = simulatePythonExecution(code);
                document.getElementById('output4').textContent = result;
            } catch (error) {
                document.getElementById('output4').textContent = 'Error: ' + error.message;
            }
        }
    </script>
</body>
</html>
