<!-- Performance optimized template -->
{% extends 'base.html' %}

{% block title %}Your Dashboard - CodeLab{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css', v=g.css_version) }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/ide_command_center.css', v=g.css_version) }}">
{% endblock %}

{% block content %}
{% include 'components/header_bar.html' %}

<main role="main" aria-labelledby="dashboard-title" class="ide-dashboard-main">
  <h1 id="dashboard-title" class="visually-hidden">Python IDE Command Center</h1>
  
  <!-- System Announcements Terminal -->
  <div id="dashboard-announcement-block" class="ide-terminal-window ide-terminal-large" style="margin: 20px;">
    <div class="ide-terminal-header">
      <div class="ide-terminal-controls">
        <div class="ide-terminal-control close"></div>
        <div class="ide-terminal-control minimize"></div>
        <div class="ide-terminal-control maximize"></div>
      </div>
      <div class="ide-terminal-title">📢 system_announcements.py - Python IDE Command Center</div>
    </div>
    <div class="ide-terminal-content">
      <div class="ide-prompt ide-typing">print("Latest System Announcement:")</div>
      <div style="margin: 10px 0; color: var(--terminal-text);">
        <span style="color: var(--python-string);">"</span><span id="announcement-text">Loading announcement...</span><span style="color: var(--python-string);">"</span>
      </div>
      <button id="edit-announcement-btn" class="display-none" style="background: var(--ide-bg-input); border: 1px solid var(--terminal-border); color: var(--ide-text-primary); padding: 6px 12px; border-radius: 4px; font-family: var(--ide-font-mono); font-size: 12px;">Edit</button>
      <textarea id="announcement-edit-area" class="width-100 mt-10 d-none" style="background: var(--ide-bg-input); border: 1px solid var(--terminal-border); color: var(--ide-text-primary); padding: 8px; border-radius: 4px; font-family: var(--ide-font-mono); resize: vertical;"></textarea>
      <div class="mt-10 gap-10 flex d-none" id="announcement-edit-actions">
        <button id="save-announcement-btn" style="background: var(--terminal-success); border: none; color: #000; padding: 6px 18px; border-radius: 4px; font-family: var(--ide-font-mono); font-size: 12px;">Save</button>
        <button id="cancel-announcement-btn" style="background: var(--terminal-error); border: none; color: #fff; padding: 6px 18px; border-radius: 4px; font-family: var(--ide-font-mono); font-size: 12px;">Cancel</button>
      </div>
    </div>
  </div>
<div class="ide-dashboard-grid">
  <!-- Leaderboard Terminal -->
  <div class="ide-terminal-window ide-terminal-medium">
    <div class="ide-terminal-header">
      <div class="ide-terminal-controls">
        <div class="ide-terminal-control close"></div>
        <div class="ide-terminal-control minimize"></div>
        <div class="ide-terminal-control maximize"></div>
      </div>
      <div class="ide-terminal-title">🏆 leaderboard.py</div>
    </div>
    <div class="ide-terminal-content ide-leaderboard">
      <canvas id="confetti-canvas" class="position-absolute width-100 height-100 pointer-events-none z-index-10"></canvas>
      <div class="ide-leaderboard-header">get_top_students()</div>
      <div style="font-family: var(--ide-font-mono); font-size: 13px;">
        <table style="width: 100%; border-collapse: collapse; color: var(--terminal-text);">
          <thead>
            <tr style="border-bottom: 1px solid var(--terminal-border);">
              <th style="text-align: left; padding: 8px 4px; color: var(--python-keyword);">#</th>
              <th style="text-align: left; padding: 8px 4px; color: var(--python-keyword);">Student</th>
              <th style="text-align: right; padding: 8px 4px; color: var(--python-keyword);">Points</th>
            </tr>
          </thead>
          <tbody id="leaderboard-body">
            <!-- JS will populate leaderboard rows here -->
          </tbody>
        </table>
      </div>
      <div id="leaderboard-message" style="margin-top: 10px; color: var(--terminal-success); font-weight: 600;"></div>
    </div>
  </div>

  <!-- Streak Tracker Terminal -->
  <div class="ide-terminal-window ide-terminal-small">
    <div class="ide-terminal-header">
      <div class="ide-terminal-controls">
        <div class="ide-terminal-control close"></div>
        <div class="ide-terminal-control minimize"></div>
        <div class="ide-terminal-control maximize"></div>
      </div>
      <div class="ide-terminal-title">🔥 streak_tracker.py</div>
    </div>
    <div class="ide-terminal-content">
      <div class="ide-prompt">check_current_streak()</div>
      <div id="streak-content" style="margin-top: 10px; color: var(--terminal-text);">
        <div>Loading your streak...</div>
      </div>
    </div>
  </div>

  <!-- Recent Activity Terminal -->
  <div class="ide-terminal-window ide-terminal-medium">
    <div class="ide-terminal-header">
      <div class="ide-terminal-controls">
        <div class="ide-terminal-control close"></div>
        <div class="ide-terminal-control minimize"></div>
        <div class="ide-terminal-control maximize"></div>
      </div>
      <div class="ide-terminal-title">📈 activity_monitor.py</div>
    </div>
    <div class="ide-terminal-content">
      <div class="ide-prompt">get_recent_activity(user_id)</div>
      <div id="recent-activity-content" style="margin-top: 10px; color: var(--terminal-text);">
        <div>Loading your recent progress...</div>
      </div>
    </div>
  </div>

  <!-- Upcoming Assignments Terminal -->
  <div class="ide-terminal-window ide-terminal-small">
    <div class="ide-terminal-header">
      <div class="ide-terminal-controls">
        <div class="ide-terminal-control close"></div>
        <div class="ide-terminal-control minimize"></div>
        <div class="ide-terminal-control maximize"></div>
      </div>
      <div class="ide-terminal-title">📅 assignments.py</div>
    </div>
    <div class="ide-terminal-content">
      <div class="ide-prompt">get_upcoming_deadlines()</div>
      <div id="upcoming-content" style="margin-top: 10px; color: var(--terminal-text);">
        <div>Loading upcoming assignments...</div>
      </div>
    </div>
  </div>

  <!-- Study Tips Terminal -->
  <div class="ide-terminal-window ide-terminal-small">
    <div class="ide-terminal-header">
      <div class="ide-terminal-controls">
        <div class="ide-terminal-control close"></div>
        <div class="ide-terminal-control minimize"></div>
        <div class="ide-terminal-control maximize"></div>
      </div>
      <div class="ide-terminal-title">💡 study_tips.py</div>
    </div>
    <div class="ide-terminal-content">
      <div class="ide-prompt">get_daily_tip()</div>
      <div id="study-tips-content" style="margin-top: 10px; color: var(--terminal-text);">
        <div>Loading study tip...</div>
      </div>
    </div>
  </div>

  <!-- Resume Last Lesson Terminal -->
  <div class="ide-terminal-window ide-terminal-small">
    <div class="ide-terminal-header">
      <div class="ide-terminal-controls">
        <div class="ide-terminal-control close"></div>
        <div class="ide-terminal-control minimize"></div>
        <div class="ide-terminal-control maximize"></div>
      </div>
      <div class="ide-terminal-title">▶️ session_manager.py</div>
    </div>
    <div class="ide-terminal-content">
      <div class="ide-prompt">resume_last_session()</div>
      <div id="resume-content" style="margin-top: 10px; color: var(--terminal-text);">
        <div>Loading last lesson...</div>
      </div>
    </div>
  </div>

  <!-- Badges & Achievements Terminal -->
  <div class="ide-terminal-window ide-terminal-small">
    <div class="ide-terminal-header">
      <div class="ide-terminal-controls">
        <div class="ide-terminal-control close"></div>
        <div class="ide-terminal-control minimize"></div>
        <div class="ide-terminal-control maximize"></div>
      </div>
      <div class="ide-terminal-title">🏅 achievements.py</div>
    </div>
    <div class="ide-terminal-content">
      <div class="ide-prompt">get_user_badges()</div>
      <div id="badges-content" style="margin-top: 10px; color: var(--terminal-text);">
        <div>Loading your badges...</div>
      </div>
    </div>
  </div>

  <!-- Motivational Quote Terminal -->
  <div class="ide-terminal-window ide-terminal-small">
    <div class="ide-terminal-header">
      <div class="ide-terminal-controls">
        <div class="ide-terminal-control close"></div>
        <div class="ide-terminal-control minimize"></div>
        <div class="ide-terminal-control maximize"></div>
      </div>
      <div class="ide-terminal-title">💬 motivation.py</div>
    </div>
    <div class="ide-terminal-content">
      <div class="ide-prompt">get_daily_motivation()</div>
      <div id="motivation-content" style="margin-top: 10px; color: var(--terminal-text);">
        <div>Loading motivation...</div>
      </div>
    </div>
  </div>

  <!-- Bell Ringer (Daily Challenge) IDE Terminal -->
  <div class="ide-terminal-window ide-terminal-large">
    <div class="ide-terminal-header">
      <div class="ide-terminal-controls">
        <div class="ide-terminal-control close"></div>
        <div class="ide-terminal-control minimize"></div>
        <div class="ide-terminal-control maximize"></div>
      </div>
      <div class="ide-terminal-title">🚀 daily_challenge.py - Interactive Python Console</div>
    </div>
    <div class="ide-terminal-content">
      <div class="ide-prompt">execute_daily_challenge()</div>
      <div id="bellringer-title" style="color: var(--python-function); font-weight: 600; margin: 10px 0;"></div>
      <div id="bellringer-desc" style="color: var(--terminal-text); margin-bottom: 15px; line-height: 1.5;"></div>
      
      <!-- Code Editor Area -->
      <div style="background: var(--ide-bg-input); border: 1px solid var(--terminal-border); border-radius: 4px; margin: 10px 0;">
        <div style="background: var(--ide-bg-tertiary); padding: 6px 12px; border-bottom: 1px solid var(--terminal-border); font-size: 12px; color: var(--ide-text-secondary);">
          📝 editor.py
        </div>
        <div id="bellringer-ide" style="height: 180px; width: 100%; background: var(--ide-bg-input);"></div>
      </div>
      
      <!-- Terminal Controls -->
      <div style="margin: 10px 0; display: flex; gap: 10px; align-items: center;">
        <button id="bellringer-run" style="background: var(--terminal-success); border: none; color: #000; padding: 8px 18px; border-radius: 4px; font-family: var(--ide-font-mono); font-size: 13px; cursor: pointer; font-weight: 600;">
          ▶️ Run Code
        </button>
        <span style="color: var(--ide-text-muted); font-size: 12px;">Ctrl+Enter</span>
      </div>
      
      <!-- Terminal Output -->
      <div style="background: var(--terminal-bg); border: 1px solid var(--terminal-border); border-radius: 4px; margin: 10px 0;">
        <div style="background: var(--ide-bg-tertiary); padding: 6px 12px; border-bottom: 1px solid var(--terminal-border); font-size: 12px; color: var(--ide-text-secondary);">
          📋 output.log
        </div>
        <pre id="bellringer-output" style="background: var(--terminal-bg); color: var(--terminal-text); padding: 12px; margin: 0; font-family: var(--ide-font-mono); font-size: 13px; min-height: 50px; overflow-x: auto;">Ready to run...</pre>
      </div>
      
      <div id="bellringer-award" style="margin-top: 10px; color: var(--terminal-success); font-weight: 600; font-family: var(--ide-font-mono);"></div>
    </div>
  </div>
</div>

<!-- What's Next Terminal -->
<div class="ide-terminal-window ide-terminal-medium" style="margin: 20px;">
  <div class="ide-terminal-header">
    <div class="ide-terminal-controls">
      <div class="ide-terminal-control close"></div>
      <div class="ide-terminal-control minimize"></div>
      <div class="ide-terminal-control maximize"></div>
    </div>
    <div class="ide-terminal-title">🗺️ path_navigator.py</div>
  </div>
  <div class="ide-terminal-content">
    <div class="ide-prompt">get_next_learning_path()</div>
    <div id="whats-next-content" style="margin-top: 10px; color: var(--terminal-text);">
      <!-- JS will populate what's next content here -->
    </div>
  </div>
</div>
</main>
{% endblock %}

{% block scripts %}
{{ super() }}
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script src="{{ url_for('static', filename='js/ide_command_center.js', v=g.css_version) }}"></script>
{% endblock %}
</body>
</html>