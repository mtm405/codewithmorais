{% extends 'base.html' %}
{% block title %}Store - CodeLab{% endblock %}
{% block content %}
<div class="header-bar">
    <h1 class="greeting"><span class="material-symbols-outlined">storefront</span> Store</h1>
    <div class="user-currency">
        <span class="material-symbols-outlined coin-icon">token</span>
        <span id="currency-value">{{ user_currency | default(0) }}</span>
    </div>
</div>
<div class="dashboard-grid store-dashboard-grid">
    <div class="store-items-list" id="store-items-list">
        <!-- JS will populate store items here -->
    </div>
    {% if session.get('is_admin') %}
    <button class="add-store-item-btn" id="add-store-btn" title="Add Store Item">+</button>
    {% endif %}
</div>
{% endblock %}
{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/store.css') }}">
{% endblock %}
{% block scripts %}
{{ super() }}
<script>
function loadStoreItems() {
    fetch('/api/admin/store')
        .then(res => res.json())
        .then(items => {
            const list = document.getElementById('store-items-list');
            list.innerHTML = '';
            items.forEach(item => {
                const div = document.createElement('div');
                div.className = 'store-item-card dashboard-option';
                div.id = `store-item-${item.id}`;
                div.innerHTML = `
                    <div class="store-item-image">${item.img || 'ðŸ›’'}</div>
                    <div class="store-item-title">${item.name}</div>
                    <div class="store-item-desc">${item.desc || ''}</div>
                    <div class="store-item-price"><span class="material-symbols-outlined coin-icon">token</span> ${item.price}</div>
                    <button class="store-buy-btn" data-id="${item.id}">Buy</button>
                    <button class="pin-btn" title="Pin">ðŸ“Œ</button>
                `;
                list.appendChild(div);
            });
        });
}
document.addEventListener('DOMContentLoaded', loadStoreItems);
</script>
{% endblock %}